<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Tempo Trails Dashboard</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <style>
    body { margin:0; font-family: sans-serif; background:#0C0C0C; color:white; }
    header { background:#111; position:sticky; top:0; z-index:1000; display:flex; }
    header a { flex:1; padding:15px; text-align:center; color:#00FFE0; text-decoration:none; }
    header a.active, header a:hover { background:#222; }
    #map { height:300px; margin:20px; border:2px solid #00FFE0; border-radius:8px;}
    .container { display:flex; flex-wrap:wrap; gap:20px; padding:20px; }
    .card { background:#1a1a1a; border:1px solid #00FFE0; border-radius:8px; width:260px; cursor:pointer; transition:0.2s; }
    .card:hover { transform:scale(1.02); }
    .card img { width:100%; height:160px; object-fit:cover; border-bottom:1px solid #00FFE0;}
    .card-content { padding:10px; }
    .card-content h3 { margin:0; color:#00FFE0; }
    .section { display:none; }
    .section.active { display:block; }
  </style>
</head>
<body>

<header>
  <a href="#" data-section="venues" class="active">Venues</a>
  <a href="#" data-section="events">Events</a>
  <a href="#" data-section="trails">Trails</a>
  <a href="#" data-section="artists">Artists</a>
  <a href="#" data-section="groups">Groups</a>
  <a href="#" data-section="tickets">Tickets</a>
</header>

<div id="map"></div>

<section id="venues" class="section active"><div class="container" id="venuesContainer"></div></section>
<section id="events" class="section"><div class="container" id="eventsContainer"></div></section>
<section id="trails" class="section"><div class="container" id="trailsContainer"></div></section>
<section id="artists" class="section"><div class="container" id="artistsContainer"></div></section>
<section id="groups" class="section"><div class="container" id="groupsContainer"></div></section>
<section id="tickets" class="section"><div class="container" id="ticketsContainer"></div></section>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const placeholder = 'https://via.placeholder.com/260x160.png?text=No+Image';
  const map = L.map('map').setView([41.88, -87.63], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution:'Â© OpenStreetMap' }).addTo(map);

  let markers = [];
  const endpoints = {
    venues: {url:'chicago_venues.json', lat:'lat', lng:'lng', title:item => item.name},
    events: {url:'events_data.json', lat:'lat', lng:'lng', title:item => item.name},
    trails: {url:'Events_Trails.json', lat:null, lng:null, title:item => item.trail_name},
    artists: {url:'artists_placeholder.json', lat:'lat', lng:'lng', title:item => item.name},
    groups: {url:'community_groups.json', lat:'lat', lng:'lng', title:item => item.name},
    tickets: {url:'ticket_sellers.json', lat:'lat', lng:'lng', title:item => item.name},
  };

  async function loadSection(section){
    // activate tab
    document.querySelectorAll('header a').forEach(a => a.classList.toggle('active', a.dataset.section === section));
    document.querySelectorAll('section').forEach(s => s.id === section ? s.classList.add('active') : s.classList.remove('active'));
    clearMarkers();

    const {url, lat, lng, title} = endpoints[section];
    const res = await fetch(url);
    if(!res.ok) return console.error(`Fetch ${url} failed ${res.status}`);
    const data = await res.json();
    const arr = Array.isArray(data) ? data : [data];
    const container = document.getElementById(section + 'Container');
    container.innerHTML = '';

    arr.forEach(item => {
      const img = item.image?.trim() ? item.image : placeholder;
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `<img src="${img}" onerror="this.src='${placeholder}'"><div class="card-content"><h3>${title(item)}</h3></div>`;
      container.appendChild(card);

      if(lat && lng && item[lat] !== undefined && item[lng] !== undefined){
        const marker = L.marker([item[lat], item[lng]]).addTo(map).bindPopup(`<b>${title(item)}</b>`);
        markers.push(marker);
        card.addEventListener('click', () => {
          map.setView(marker.getLatLng(), 14, {animate:true});
          marker.openPopup();
        });
      }
    });
  }

  function clearMarkers(){
    markers.forEach(m => map.removeLayer(m));
    markers = [];
  }

  document.querySelectorAll('header a').forEach(a => {
    a.addEventListener('click', e => {
      e.preventDefault();
      loadSection(a.dataset.section);
    });
  });

  loadSection('venues'); // load default
</script>

</body>
</html>
